#!/bin/bash

# firewall init commands
# reset
nft delete table inet share_user
# make table
nft add table inet share_user
# firewall share user from the internet completely
# requires ipt_owner module
#nft add rule inet share_user filter output ct state related,established  counter accept
# create a new chain
nft 'add chain inet share_user input { type filter hook input priority 0 ; }'
nft 'add chain inet share_user output { type filter hook output priority 0 ; }'
# use new chain to process packets generated by that user
nft add rule inet share_user filter output skuid 1010 counter jump share_user
nft add rule inet share_user filter input skuid 1010 counter jump share_user
# Allow ssh port
nft add rule inet share_user tcp daddr dport 773 counter accept
# reject everything else
nft add rule inet share_user filter output skuid 1010 counter jump share_user

